#! /bin/bash 
if [ $# -lt 1 ]; then
    echo "Usage: $0 dbName"
    exit 1
fi

LEN=$(echo ${#1})
if [ $LEN -gt 8 ]; then
    echo "The maximum length of the database name is 8 chars"
    exit 1
fi

db2 -v -t << EOF
  CREATE DATABASE $1 USING CODESET ISO-8859-1 TERRITORY IT;
  CONNECT TO $1;
  CREATE BUFFERPOOL BP3 SIZE 2000 PAGESIZE 8K;
  CREATE TABLESPACE USERSPACE3 PAGESIZE 8K MANAGED BY SYSTEM USING ('/home/db2inst1/db2inst1/NODE0000/$1/T3/C3.LRG') BUFFERPOOL BP3;
  CREATE BUFFERPOOL tmp3 SIZE 2000 PAGESIZE 32K;
  CREATE TEMPORARY TABLESPACE tUSERSPACE3 PAGESIZE 32K MANAGED BY SYSTEM USING ('/home/db2inst1/db2inst1/NODE0000/$1/Tt3/tC3.LRG') BUFFERPOOL tmp3;
  GRANT DBADM, CREATETAB, BINDADD, CONNECT, CREATE_NOT_FENCED, IMPLICIT_SCHEMA, LOAD ON DATABASE TO USER asup;
  UPDATE DATABASE CONFIGURATION FOR $1 USING LOGFILSIZ 1000;
  UPDATE DATABASE CONFIGURATION FOR $1 USING LOGPRIMARY 10;
  UPDATE DATABASE CONFIGURATION FOR $1 USING LOGSECOND 3;
  QUIT;
EOF

echo "Database $1 created"
